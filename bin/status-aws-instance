#!/usr/bin/env bash

typeset -r REGION="$1"
typeset -r INSTANCE_NAME="$2"

if [[ -z $REGION || -z $INSTANCE_NAME ]]; then
  echo "usage: start-aws-instance <region> <instance-name>" >&2
  exit 1
fi

typeset describe="$(aws ec2 describe-instances --region "$REGION" --filters "Name=tag:Name,Values=$INSTANCE_NAME")"

if [[ $(echo "$describe" | jq -r '.Reservations | length == 0') == true ]]; then
  echo "there are no instances with that name in this region" >&2
  exit 1
fi

echo "$describe" | jq -r '.Reservations[0].Instances[0]'
